package com.whty.common.util;

import java.util.Calendar;

import com.baidubce.services.bos.BosClient;

public class BaiduBosUtils {

	/**
	 * 根据文件名生成bos的key
	 * 
	 * @param fileName
	 * @return
	 */
	public static String getKey(String userId, String fileName) {
		StringBuffer bosStringBuffer = new StringBuffer();

		Calendar cal = Calendar.getInstance();
		int year = cal.get(Calendar.YEAR);
		int month = cal.get(Calendar.MONTH) + 1;
		int date = cal.get(Calendar.DATE);

		bosStringBuffer.append("zhkt").append(SysConfigUtils.getStrValue("projectName")).append("/").append(year)
				.append("/").append(month).append("/").append(date).append("/").append(userId).append("/")
				.append(fileName);

		return bosStringBuffer.toString();
	}

	/**
	 * 删除百度文件
	 * 删除的url路径必须包含3层目录
	 * @param client
	 * @param bucketName   bucketName
	 * @param objectKey  文件url路径，不包含 域名
	 * 例如 http://whty.bj.bcebos.com/hdcourse/test/201879/15337938629811533793858441.txt  objectKe传/hdcourse/test/201879/15337938629811533793858441.txt
	 * @return 删除成功返回true
	 */
	public static boolean deleteFile(BosClient client, String bucketName, String objectKey) {
		String[] dirList = objectKey.split("/");

		boolean result = false;

		if (dirList.length < 3)
			return result;

		client.deleteObject(bucketName, objectKey);
		return result;
	}

//	public static void main(String[] args) {
//		deleteFile(client, bucketName, objectKey)
//		
//		String sa = "hdcourse/test/201879/15337938629811533793858441.txt";
//		String[] s = sa.split("/");
//
//		System.out.println(s.length);
//	}

}
