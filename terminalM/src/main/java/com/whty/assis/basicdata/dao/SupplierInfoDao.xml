<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.whty.assis.basicdata.dao.SupplierInfoDao">

	<!-- 这里的Demo是别名，需要在mybatis-config.xml中定义，或者写类全名 -->
	<resultMap type="com.whty.assis.basicdata.model.SupplierInfo" id="SupplierInfoResult">
		<id property="id" column="id" />
		<result property="name" column="name" />
		<result property="creator"     column="creator" />
		<result property="creatorName" column="creator_name" />
		<result property="createTime" column="create_time" />
		<result property="updateTime" column="update_time" />
		<result property="supplierNum" column="supplier_num" />
		<result property="address" column="address" />
		<result property="contact" column="contact" />
		<result property="contactTel" column="contact_tel" />
		
		<result property="terminalDeviceTypeId" column="terminal_device_type_id" />
		
	</resultMap>
	
	
	<delete id="deleteById" parameterType="int">
		delete from t_supplier_info where id=#{_parameter}
	</delete>
	
	
	<insert id="save" parameterType="com.whty.assis.basicdata.model.SupplierInfo">
		insert into t_supplier_info(
			name,
			creator,
			create_time,
			update_time,
			contact,
			contact_tel,
			terminal_device_type_id,
			<if test="memo != null and memo != ''">memo,</if>
			<if test="address != null and address != ''">address,</if>
			supplier_num
			) values (
				#{name},
				#{creator},
				#{createTime},
				#{updateTime},
				#{contact},
				#{contactTel},
				#{terminalDeviceTypeId},
				<if test="memo != null and memo != ''">#{memo},</if>
				<if test="address != null and address != ''">#{address},</if>
				#{supplierNum}
			)
	</insert>
	
	<update id="update" parameterType="com.whty.assis.basicdata.model.SupplierInfo">
		update t_supplier_info
		set 
		<trim prefixOverrides=",">
			<if test="updateTime != null ">, update_time=#{updateTime}</if>
			<if test="memo != null ">, memo=#{memo}</if>
			<if test="name != null and name != ''">, name=#{name}</if>
			<if test="address != null and address != ''">, address=#{address}</if>
			<if test="contact != null and contact != ''">, contact=#{contact}</if>
			<if test="contactTel != null and contactTel != ''">, contact_tel=#{contactTel}</if>
		</trim>
		where id=#{id}
	</update>
	
	<select id="loadById" parameterType="int"  resultMap="SupplierInfoResult">
	select t1.*,t2.user_name as creator_name from t_supplier_info t1 left join ta_manage_user_info t2 on t1.creator=t2.id
		where 1=1 and t1.id=#{id}
	</select>
	
	<select id="listByCondition" parameterType="map" resultMap="SupplierInfoResult">
		select t1.*,t2.user_name as creator_name from t_supplier_info t1 left join ta_manage_user_info t2 on t1.creator=t2.id
		where 1=1
		<if test="id != null ">and t1.id=#{id}</if>
		<if test="name != null and name != '' " >and t1.name=#{name}</if>
		<if test="supplierNum != null and supplierNum !='' ">and t1.supplier_num=#{supplierNum}</if>
		<if test="terminalDeviceTypeId != null and terminalDeviceTypeId !='' ">and t1.terminal_device_type_id=#{terminalDeviceTypeId}</if>
		order by t1.create_time desc
	</select>
	
	
</mapper>