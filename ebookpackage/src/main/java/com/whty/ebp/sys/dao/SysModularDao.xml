<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.whty.ebp.sys.dao.SysModularDao">
	<resultMap type="com.whty.ebp.sys.model.SysModular" id="SysModularResult">
		<result column="id" property="id" jdbcType="VARCHAR" />
		<result column="modular_name" property="modularName" jdbcType="VARCHAR" />
		<result column="modular_path" property="modularPath" jdbcType="VARCHAR" />
		<result column="modular_sort" property="modularSort" jdbcType="VARCHAR" />
		<result column="parent_id" property="parentId" jdbcType="VARCHAR" />
		<result column="is_parent" property="isParent" jdbcType="VARCHAR" />
		<result column="status" property="status" jdbcType="VARCHAR" />
		<result column="imgcss" property="imgcss" jdbcType="VARCHAR" />
	</resultMap>
	
	<!-- 根据条件查询 -->
	<select id="listByCondition" parameterType="map" resultMap="SysModularResult">
		select m.id,m.modular_name,m.modular_path,m.modular_sort,
			m.parent_id,m.is_parent,m.status,m.imgcss 
		from SYS_MODULAR m,SYS_ROLE_MODULAR r,SYS_USER_ROLE s
		where m.status = 0
		     and m.id = r.modular_id
		     and r.role_id = s.role_id
		     and s.user_id = #{user_id}
		order by m.modular_sort
	</select>
	
	<select id="queryAllModular" resultMap="SysModularResult">
		select id,modular_name,modular_path,modular_sort,parent_id,is_parent,status,imgcss from SYS_MODULAR order by modular_sort
	</select>

	<!-- 新增 -->
	<insert id="addModular" parameterType="com.whty.ebp.sys.model.SysModular">
		insert into SYS_MODULAR (id,modular_name,modular_path,modular_sort,parent_id,is_parent,status,imgcss) 
		values(#{id,jdbcType=VARCHAR},#{modularName,jdbcType=VARCHAR},#{modularPath,jdbcType=VARCHAR},#{modularSort,jdbcType=INTEGER},
			#{parentId,jdbcType=VARCHAR},#{isParent,jdbcType=INTEGER},#{status,jdbcType=INTEGER},#{imgcss,jdbcType=VARCHAR})
	</insert>

	<!-- 删除 -->
	<delete id="deleteModular" parameterType="java.util.List">
		delete from SYS_MODULAR
		where id in <foreach collection="list" item="id" separator="," open="(" close=")">#{id}</foreach>
	</delete>
	<!-- 修改 -->
	<update id="updateModular" parameterType="map">
		update SYS_MODULAR 
		set modular_name=#{modularName,jdbcType=VARCHAR},modular_path=#{modularPath,jdbcType=VARCHAR},
			status=#{status},modular_sort=#{modularSort},imgcss=#{imgcss,jdbcType=VARCHAR}
		where id=#{id}
	</update>
</mapper>